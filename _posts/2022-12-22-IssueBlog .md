---
title: 如何快速地上线一个项目？
date: 2022-12-22 14:19:00 +0800
categories: [技术科普]
tags: [学习]
pin: true
author: YKFire

toc: true
comments: true

math: false
mermaid: true

typora-root-url: ../../YKFire.github.io

---

# 如何快速地上线一个项目？

> 本文将提供一种快速上线项目的方法，适合已经了解上线项目流程的读者进行阅读，且项目以前后端分离的项目为例。

## 一、多环境

> 多环境是指同一套代码在不同的阶段**需要根据实际情况来调整配置**部署到不同的机器上

### 1.环境的分类：

- 本地环境：自己的电脑
- 开发环境：团队开发 拥有远程服务器
- 测试环境：性能测试/功能测试/系统集成测试**  独立的数据库与服务器 与生产环境并不相同
- 预发布环境：调用的后端接口、连接的数据库、服务等都 **和线上项目一致** ，和线上唯一的区别就是前端访问的域名不同  **类似体验服**
- 生产环境：正式服
- 沙箱环境：测试环境的一种  为了测试某个功能而单独开辟的环境  **用完即删**

### 2.多环境的实现方式

- 抽象配置类
- 配置文件化
- 注入环境参数

### 3.为什么需要多环境

- 每个环境互不影响
- 区分项目开发的不同阶段
- 方便对项目进行优化

### 4.前端多环境实战

- 请求地址修改

  - 开发环境：localhost

  - 生产环境：xxxx.com

  - 项目如何知道何时请求哪种地址

    ```tsx
    startFront(env){
    	if(env === 'prod'){
    		//使用生成环境
    		//不输出注释
    		//修改请求地址
    	}
    	if(env === 'ex'){
    		//使用开发环境
    	}
    }
    ```

- 启动方式

  - 开发环境：npm run start （本地启动，监听端口，自动更新）
  - 线上环境：npm run build（由umi为我们提供的）

- 配置文件的不同

  - 开发环境与生产环境 配置文件的不同  eg：config.dev.ts  config.prod.ts(以umi框架举例)
  - 是否选择静态化

### 5.后端多环境实战

> 主要适用于Spring Boot项目 

- 配置文件的修改
  - 添加**不同的后缀名** application-prod.yml  **作为生产环境版本 ** 添加相对应的配置文件
- 修改生产环境下数据库的配置 （等其他中间件也类似，例如缓存redis）
  - 注意不同环境下的版本最好一致
- 生产环境下的版本如何在本地运行
  - 将项目打包为jar包 （使用idea提供的maven可视化工具）
  - 启动项目：命令行输入 java -jar  +  环境变量(--spring.profiles.active = prod)

## 二、项目上线的前置条件

### 前置条件

- 已经能够上线的项目源码
  - 前端项目build成dist目录，后端项目打包成jar包
- 一台云服务服务器
  - 市面上主流的云服务器都可以，以下将给出主流服务器的区别

### 腾讯云与阿里云的区别

腾讯云：

- 价格实惠、独享带宽多、100%CPU
- 但是经常促销老机型，有时候性能跟不上
- 适合个人开发学习使用

阿里云：

- 技术全面、综合能力强、机型崭新
- 但是会限制CPU而且续费价格昂贵
- 适合团队、整体开发生产

## 三、宝塔Linux可视化界面部署

> 登陆宝塔Linux面板，可以使用云服务器自带的宝塔面板，也可以自己自行到官网进行下载，环境稳定版本以文中图片为主。

### 1.前端环境配置

点击软件商店安装nginx

![安装nginx](/assets/blog_res/2022-12-22-IssueBlog%20.assets/image-20221222144127902.png)

### 2.后端环境配置

点击软件商店安装tomcat(主要是为了安装java，安装后记得将tomcat关闭避免占用8080端口)

![image-20221222144336198](/assets/blog_res/2022-12-22-IssueBlog%20.assets/image-20221222144336198.png)

### 3.其他环境配置

> 一般根据自己的项目所使用到的技术栈进行配置

- mysql配置
- redis配置
- rabbitMQ配置
- 等等

以MySQL为例，点击软件商店选择对应的版本后进行下载即可，在这之后再将相关的数据库表数据上传到云服务器中

![image-20221222151018159](/assets/blog_res/2022-12-22-IssueBlog%20.assets/image-20221222151018159.png)

### 4.运行项目

点击网站模块进行部署项目

#### 前端项目

> 将前端构建好的项目上传到对应的目录，并在**根目录**绑定

点击添加站点，输入对应的域名/端口号吗，填写好备注以及根目录，其余不用做修改，点击**提交**，项目则部署成功

![image-20221222144823748](/assets/blog_res/2022-12-22-IssueBlog%20.assets/image-20221222144823748.png)

#### 后端项目

> 将前端项目打包好的jar包上传到对应的目录，并在**项目jar路径**进行绑定

点击网站的**Java项目模块**，根据要求选择要运行的jar包，再设置项目的运行端口号，项**目的执行指令**也可以自己进行修改(JVM的配置或者使用prod配置文件)，点击**提交**后端项目则部署成功

![image-20221222145443604](/assets/blog_res/2022-12-22-IssueBlog%20.assets/image-20221222145443604.png)

> 至此前后端项目已经最基本的部署已经成功了，在此基础之上还可以去去添加域名，对项目的业务进一步进行优化。

## 四、绑定域名

### 1.域名解析流程

用户输入网址 => 域名解析服务器(把网址解析为ip地址(其对应的端口号服务)/交给其他的域名解析服务) => 服务接受请求，返回文件给前端 => 前端加载文件到浏览器(js、css)/后端返回对应的数据

- 进入域名的注册商 （DNSPod服务）
- 查询文档进行相关配置即可
- 记得修改nginx的域名管理

### 2.ip地址与域名的区别

- **ip地址通常指定的是服务器**，也就是主机，即我们在云服务厂商购买的**轻量级云服务器**
- 建立网站是需要**域名**和**主机(云服务器)**两者的
- 上线项目时可以将**域名**与**服务器的ip地址的端口号**进行绑定
- 域名可以理解为**人的名字**  ip地址可以理解为**人的身份证号** 我们与别人交流通常是通过叫对方的名字 而不是通过身份证号  **但人必须有身份证号**(即必须有自己的云服务器)